# Run VAR model
VAR_est <- VAR(data_for_var, ic = "AIC", lag.max = 21)
coefs <-coeftest(VAR_est)
summ <- summary(VAR_est)
lag_selected <- VARselect(data_for_var, lag.max = 21, type = "both")
#print(coefs)
print(summ)
print(Ticker)
print(lag_selected)
# Run Granger Causality Test
causal <- causality(VAR_est, cause="war_interest")["Granger"]
#print(causal)
var_ticker[Ticker,1] <- causal$Granger$p.value
# Run Granger Causality Test other way (check if index has influence on crisis measure)
causal_ticker <- causality(VAR_est, cause="ticker")["Granger"]
#print(causal_ticker)
var_ticker[Ticker,2] <- causal_ticker$Granger$p.value
# Run Granger Causality Test for inflation
causal_ticker <- causality(VAR_est, cause="inflation")["Granger"]
#print(causal_ticker)
var_ticker[Ticker,3] <- causal_ticker$Granger$p.value
# Store selected lag for information criterion
lag_selected_matrix[Ticker, 'AIC'] <- lag_selected$selection["AIC(n)"]
lag_selected_matrix[Ticker, 'HQ'] <- lag_selected$selection["HQ(n)"]
lag_selected_matrix[Ticker, 'SC'] <- lag_selected$selection["SC(n)"]
lag_selected_matrix[Ticker, 'FPE'] <- lag_selected$selection["FPE(n)"]
# Impulse response functions
plot(irf(VAR_est, impulse="war_interest", response="ticker"), main=Ticker)
}
lag_selected$selection["HQ(n)"]
# Create ticker list
ticker_cols <- colnames(war_ticker_inflation_df)[3:4]
# Create matrix to store p.Values of Granger-Test
var_ticker <- matrix(NA, ncol = 3, nrow = 2)
colnames(var_ticker) <- c('p.Value.war','p.Value.index', 'p.Value.inflation')
rownames(var_ticker) <- colnames(war_ticker_df)[3:4]
# Create matrix to store selected lags
lag_selected_matrix <- matrix(NA, ncol = 4, nrow = length(ticker_cols))
colnames(lag_selected_matrix) <- c('AIC', 'HQ', 'SBIC', 'FPE')
rownames(lag_selected_matrix) <- ticker_cols
for (Ticker in ticker_cols) {
# Create data for VAR
print(Ticker)
data_for_var <- cbind(war_interest=war_ticker_inflation_df$hits,
ticker=war_ticker_inflation_df[[Ticker]],
inflation=war_ticker_inflation_df$AVG_INFLATION)
# Run VAR model
VAR_est <- VAR(data_for_var, ic = "AIC", lag.max = 21)
coefs <-coeftest(VAR_est)
summ <- summary(VAR_est)
lag_selected <- VARselect(data_for_var, lag.max = 21, type = "both")
#print(coefs)
print(summ)
print(Ticker)
print(lag_selected)
# Run Granger Causality Test
causal <- causality(VAR_est, cause="war_interest")["Granger"]
#print(causal)
var_ticker[Ticker,1] <- causal$Granger$p.value
# Run Granger Causality Test other way (check if index has influence on crisis measure)
causal_ticker <- causality(VAR_est, cause="ticker")["Granger"]
#print(causal_ticker)
var_ticker[Ticker,2] <- causal_ticker$Granger$p.value
# Run Granger Causality Test for inflation
causal_ticker <- causality(VAR_est, cause="inflation")["Granger"]
#print(causal_ticker)
var_ticker[Ticker,3] <- causal_ticker$Granger$p.value
# Store selected lag for information criterion
lag_selected_matrix[Ticker, 'AIC'] <- lag_selected$selection["AIC(n)"]
lag_selected_matrix[Ticker, 'HQ'] <- lag_selected$selection["HQ(n)"]
lag_selected_matrix[Ticker, 'SC'] <- lag_selected$selection["SC(n)"]
lag_selected_matrix[Ticker, 'FPE'] <- lag_selected$selection["FPE(n)"]
# Impulse response functions
plot(irf(VAR_est, impulse="war_interest", response="ticker"), main=Ticker)
}
# Create ticker list
ticker_cols <- colnames(war_ticker_inflation_df)[3:4]
# Create matrix to store p.Values of Granger-Test
var_ticker <- matrix(NA, ncol = 3, nrow = 2)
colnames(var_ticker) <- c('p.Value.war','p.Value.index', 'p.Value.inflation')
rownames(var_ticker) <- colnames(war_ticker_df)[3:4]
# Create matrix to store selected lags
lag_selected_matrix <- matrix(NA, ncol = 4, nrow = length(ticker_cols))
colnames(lag_selected_matrix) <- c('AIC', 'HQ', 'SC', 'FPE')
rownames(lag_selected_matrix) <- ticker_cols
for (Ticker in ticker_cols) {
# Create data for VAR
print(Ticker)
data_for_var <- cbind(war_interest=war_ticker_inflation_df$hits,
ticker=war_ticker_inflation_df[[Ticker]],
inflation=war_ticker_inflation_df$AVG_INFLATION)
# Run VAR model
VAR_est <- VAR(data_for_var, ic = "AIC", lag.max = 21)
coefs <-coeftest(VAR_est)
summ <- summary(VAR_est)
lag_selected <- VARselect(data_for_var, lag.max = 21, type = "both")
#print(coefs)
print(summ)
print(Ticker)
print(lag_selected)
# Run Granger Causality Test
causal <- causality(VAR_est, cause="war_interest")["Granger"]
#print(causal)
var_ticker[Ticker,1] <- causal$Granger$p.value
# Run Granger Causality Test other way (check if index has influence on crisis measure)
causal_ticker <- causality(VAR_est, cause="ticker")["Granger"]
#print(causal_ticker)
var_ticker[Ticker,2] <- causal_ticker$Granger$p.value
# Run Granger Causality Test for inflation
causal_ticker <- causality(VAR_est, cause="inflation")["Granger"]
#print(causal_ticker)
var_ticker[Ticker,3] <- causal_ticker$Granger$p.value
# Store selected lag for information criterion
lag_selected_matrix[Ticker, 'AIC'] <- lag_selected$selection["AIC(n)"]
lag_selected_matrix[Ticker, 'HQ'] <- lag_selected$selection["HQ(n)"]
lag_selected_matrix[Ticker, 'SC'] <- lag_selected$selection["SC(n)"]
lag_selected_matrix[Ticker, 'FPE'] <- lag_selected$selection["FPE(n)"]
# Impulse response functions
plot(irf(VAR_est, impulse="war_interest", response="ticker"), main=Ticker)
}
lag_selected_matrix
# Print selected lags of VAR
knitr::kable(lag_selected_matrix)
# Create ticker list
ticker_cols <- colnames(war_ticker_inflation_df)[3:4]
# Create matrix to store p.Values of Granger-Test
var_ticker <- matrix(NA, ncol = 3, nrow = 2)
colnames(var_ticker) <- c('p.Value.war','p.Value.index', 'p.Value.inflation')
rownames(var_ticker) <- colnames(war_ticker_df)[3:4]
# Create matrix to store selected lags
lag_selected_matrix <- matrix(NA, ncol = 4, nrow = length(ticker_cols))
colnames(lag_selected_matrix) <- c('AIC', 'HQ', 'SC', 'FPE')
rownames(lag_selected_matrix) <- ticker_cols
# List to store plots
for (Ticker in ticker_cols) {
# Create data for VAR
print(Ticker)
data_for_var <- cbind(war_interest=war_ticker_inflation_df$hits,
ticker=war_ticker_inflation_df[[Ticker]],
inflation=war_ticker_inflation_df$AVG_INFLATION)
# Run VAR model
VAR_est <- VAR(data_for_var, ic = "AIC", lag.max = 21)
coefs <-coeftest(VAR_est)
summ <- summary(VAR_est)
lag_selected <- VARselect(data_for_var, lag.max = 21, type = "both")
#print(coefs)
print(summ)
print(Ticker)
print(lag_selected)
# Run Granger Causality Test
causal <- causality(VAR_est, cause="war_interest")["Granger"]
#print(causal)
var_ticker[Ticker,1] <- causal$Granger$p.value
# Run Granger Causality Test other way (check if index has influence on crisis measure)
causal_ticker <- causality(VAR_est, cause="ticker")["Granger"]
#print(causal_ticker)
var_ticker[Ticker,2] <- causal_ticker$Granger$p.value
# Run Granger Causality Test for inflation
causal_ticker <- causality(VAR_est, cause="inflation")["Granger"]
#print(causal_ticker)
var_ticker[Ticker,3] <- causal_ticker$Granger$p.value
# Store selected lag for information criterion
lag_selected_matrix[Ticker, 'AIC'] <- lag_selected$selection["AIC(n)"]
lag_selected_matrix[Ticker, 'HQ'] <- lag_selected$selection["HQ(n)"]
lag_selected_matrix[Ticker, 'SC'] <- lag_selected$selection["SC(n)"]
lag_selected_matrix[Ticker, 'FPE'] <- lag_selected$selection["FPE(n)"]
# Save Impulse response functions
plot(irf(VAR_est, impulse="war_interest", response="ticker"), main=Ticker)
plots_list[[Ticker]] <- recordPlot()
}
# Create ticker list
ticker_cols <- colnames(war_ticker_inflation_df)[3:4]
# Create matrix to store p.Values of Granger-Test
var_ticker <- matrix(NA, ncol = 3, nrow = 2)
colnames(var_ticker) <- c('p.Value.war','p.Value.index', 'p.Value.inflation')
rownames(var_ticker) <- colnames(war_ticker_df)[3:4]
# Create matrix to store selected lags
lag_selected_matrix <- matrix(NA, ncol = 4, nrow = length(ticker_cols))
colnames(lag_selected_matrix) <- c('AIC', 'HQ', 'SC', 'FPE')
rownames(lag_selected_matrix) <- ticker_cols
# List to store plots
plots_list <- list()
for (Ticker in ticker_cols) {
# Create data for VAR
print(Ticker)
data_for_var <- cbind(war_interest=war_ticker_inflation_df$hits,
ticker=war_ticker_inflation_df[[Ticker]],
inflation=war_ticker_inflation_df$AVG_INFLATION)
# Run VAR model
VAR_est <- VAR(data_for_var, ic = "AIC", lag.max = 21)
coefs <-coeftest(VAR_est)
summ <- summary(VAR_est)
lag_selected <- VARselect(data_for_var, lag.max = 21, type = "both")
#print(coefs)
print(summ)
print(Ticker)
print(lag_selected)
# Run Granger Causality Test
causal <- causality(VAR_est, cause="war_interest")["Granger"]
#print(causal)
var_ticker[Ticker,1] <- causal$Granger$p.value
# Run Granger Causality Test other way (check if index has influence on crisis measure)
causal_ticker <- causality(VAR_est, cause="ticker")["Granger"]
#print(causal_ticker)
var_ticker[Ticker,2] <- causal_ticker$Granger$p.value
# Run Granger Causality Test for inflation
causal_ticker <- causality(VAR_est, cause="inflation")["Granger"]
#print(causal_ticker)
var_ticker[Ticker,3] <- causal_ticker$Granger$p.value
# Store selected lag for information criterion
lag_selected_matrix[Ticker, 'AIC'] <- lag_selected$selection["AIC(n)"]
lag_selected_matrix[Ticker, 'HQ'] <- lag_selected$selection["HQ(n)"]
lag_selected_matrix[Ticker, 'SC'] <- lag_selected$selection["SC(n)"]
lag_selected_matrix[Ticker, 'FPE'] <- lag_selected$selection["FPE(n)"]
# Save Impulse response functions
plot(irf(VAR_est, impulse="war_interest", response="ticker"), main=Ticker)
plots_list[[Ticker]] <- recordPlot()
}
plot_list
plots_list
plots_list$XLB.Adjusted
# Create ticker list
ticker_cols <- colnames(war_ticker_inflation_df)[3:4]
# Create matrix to store p.Values of Granger-Test
var_ticker <- matrix(NA, ncol = 3, nrow = 2)
colnames(var_ticker) <- c('p.Value.war','p.Value.index', 'p.Value.inflation')
rownames(var_ticker) <- colnames(war_ticker_df)[3:4]
# Create matrix to store selected lags
lag_selected_matrix <- matrix(NA, ncol = 4, nrow = length(ticker_cols))
colnames(lag_selected_matrix) <- c('AIC', 'HQ', 'SC', 'FPE')
rownames(lag_selected_matrix) <- ticker_cols
# List to store plots
irf_plots_list <- list()
for (Ticker in ticker_cols) {
# Create data for VAR
print(Ticker)
data_for_var <- cbind(war_interest=war_ticker_inflation_df$hits,
ticker=war_ticker_inflation_df[[Ticker]],
inflation=war_ticker_inflation_df$AVG_INFLATION)
# Run VAR model
VAR_est <- VAR(data_for_var, ic = "AIC", lag.max = 21)
coefs <-coeftest(VAR_est)
summ <- summary(VAR_est)
lag_selected <- VARselect(data_for_var, lag.max = 21, type = "both")
#print(coefs)
print(summ)
print(Ticker)
print(lag_selected)
# Run Granger Causality Test
causal <- causality(VAR_est, cause="war_interest")["Granger"]
#print(causal)
var_ticker[Ticker,1] <- causal$Granger$p.value
# Run Granger Causality Test other way (check if index has influence on crisis measure)
causal_ticker <- causality(VAR_est, cause="ticker")["Granger"]
#print(causal_ticker)
var_ticker[Ticker,2] <- causal_ticker$Granger$p.value
# Run Granger Causality Test for inflation
causal_ticker <- causality(VAR_est, cause="inflation")["Granger"]
#print(causal_ticker)
var_ticker[Ticker,3] <- causal_ticker$Granger$p.value
# Store selected lag for information criterion
lag_selected_matrix[Ticker, 'AIC'] <- lag_selected$selection["AIC(n)"]
lag_selected_matrix[Ticker, 'HQ'] <- lag_selected$selection["HQ(n)"]
lag_selected_matrix[Ticker, 'SC'] <- lag_selected$selection["SC(n)"]
lag_selected_matrix[Ticker, 'FPE'] <- lag_selected$selection["FPE(n)"]
# Save Impulse response functions
plot(irf(VAR_est, impulse="war_interest", response="ticker"), main=Ticker)
irf_plots_list[[Ticker]] <- recordPlot()
}
irf_plots_list$XLB.Adjusted
irf_plots_list$XLI.Adjusted
# Run models again, but this time without Inflation as control variable
# Create matrix to store p.Values of Granger-Test
var_ticker_without_inflation <- matrix(NA, ncol = 2, nrow = 2)
colnames(var_ticker_withouth_inflation) <- c('p.Value.war','p.Value.index')
# Run models again, but this time without Inflation as control variable
# Create matrix to store p.Values of Granger-Test
var_ticker_without_inflation <- matrix(NA, ncol = 2, nrow = 2)
colnames(var_ticker_without_inflation) <- c('p.Value.war','p.Value.index')
rownames(var_ticker_without_inflation) <- colnames(var_ticker_without_inflation)[3:4]
# Create matrix to store selected lags
var_ticker_without_inflation <- matrix(NA, ncol = 4, nrow = length(ticker_cols))
colnames(lag_selected_matrix_without_inflation) <- c('AIC', 'HQ', 'SC', 'FPE')
# Run models again, but this time without Inflation as control variable
# Create matrix to store p.Values of Granger-Test
var_ticker_without_inflation <- matrix(NA, ncol = 2, nrow = 2)
colnames(var_ticker_without_inflation) <- c('p.Value.war','p.Value.index')
rownames(var_ticker_without_inflation) <- colnames(var_ticker_without_inflation)[3:4]
# Create matrix to store selected lags
lag_selected_matrix_without_inflation <- matrix(NA, ncol = 4, nrow = length(ticker_cols))
colnames(lag_selected_matrix_without_inflation) <- c('AIC', 'HQ', 'SC', 'FPE')
rownames(lag_selected_matrix_without_inflation) <- ticker_cols
# List to store plots
irf_plots_list_without_inflation <- list()
for (Ticker in ticker_cols) {
# Create data for VAR
print(Ticker)
data_for_var <- cbind(war_interest=war_ticker_inflation_df$hits,
ticker=war_ticker_inflation_df[[Ticker]])
# Run VAR model
VAR_est <- VAR(data_for_var, ic = "AIC", lag.max = 21)
coefs <-coeftest(VAR_est)
summ <- summary(VAR_est)
lag_selected <- VARselect(data_for_var, lag.max = 21, type = "both")
#print(coefs)
print(summ)
print(Ticker)
print(lag_selected)
# Run Granger Causality Test
causal <- causality(VAR_est, cause="war_interest")["Granger"]
#print(causal)
var_ticker_without_inflation[Ticker,1] <- causal$Granger$p.value
# Run Granger Causality Test other way (check if index has influence on crisis measure)
causal_ticker <- causality(VAR_est, cause="ticker")["Granger"]
#print(causal_ticker)
var_ticker_without_inflation[Ticker,2] <- causal_ticker$Granger$p.value
# Store selected lag for information criterion
var_ticker_without_inflation[Ticker, 'AIC'] <- lag_selected$selection["AIC(n)"]
var_ticker_without_inflation[Ticker, 'HQ'] <- lag_selected$selection["HQ(n)"]
var_ticker_without_inflation[Ticker, 'SC'] <- lag_selected$selection["SC(n)"]
var_ticker_without_inflation[Ticker, 'FPE'] <- lag_selected$selection["FPE(n)"]
# Save Impulse response functions
plot(irf(VAR_est, impulse="war_interest", response="ticker"), main=Ticker)
irf_plots_list_without_inflation[[Ticker]] <- recordPlot()
}
# Run models again, but this time without Inflation as control variable
# Create matrix to store p.Values of Granger-Test
var_ticker_without_inflation <- matrix(NA, ncol = 2, nrow = 2)
colnames(var_ticker_without_inflation) <- c('p.Value.war','p.Value.index')
rownames(var_ticker_without_inflation) <- colnames(war_ticker_df)[3:4]
# Create matrix to store selected lags
lag_selected_matrix_without_inflation <- matrix(NA, ncol = 4, nrow = length(ticker_cols))
colnames(lag_selected_matrix_without_inflation) <- c('AIC', 'HQ', 'SC', 'FPE')
rownames(lag_selected_matrix_without_inflation) <- ticker_cols
# List to store plots
irf_plots_list_without_inflation <- list()
for (Ticker in ticker_cols) {
# Create data for VAR
print(Ticker)
data_for_var <- cbind(war_interest=war_ticker_inflation_df$hits,
ticker=war_ticker_inflation_df[[Ticker]])
# Run VAR model
VAR_est <- VAR(data_for_var, ic = "AIC", lag.max = 21)
coefs <-coeftest(VAR_est)
summ <- summary(VAR_est)
lag_selected <- VARselect(data_for_var, lag.max = 21, type = "both")
#print(coefs)
print(summ)
print(Ticker)
print(lag_selected)
# Run Granger Causality Test
causal <- causality(VAR_est, cause="war_interest")["Granger"]
#print(causal)
var_ticker_without_inflation[Ticker,1] <- causal$Granger$p.value
# Run Granger Causality Test other way (check if index has influence on crisis measure)
causal_ticker <- causality(VAR_est, cause="ticker")["Granger"]
#print(causal_ticker)
var_ticker_without_inflation[Ticker,2] <- causal_ticker$Granger$p.value
# Store selected lag for information criterion
var_ticker_without_inflation[Ticker, 'AIC'] <- lag_selected$selection["AIC(n)"]
var_ticker_without_inflation[Ticker, 'HQ'] <- lag_selected$selection["HQ(n)"]
var_ticker_without_inflation[Ticker, 'SC'] <- lag_selected$selection["SC(n)"]
var_ticker_without_inflation[Ticker, 'FPE'] <- lag_selected$selection["FPE(n)"]
# Save Impulse response functions
plot(irf(VAR_est, impulse="war_interest", response="ticker"), main=Ticker)
irf_plots_list_without_inflation[[Ticker]] <- recordPlot()
}
# Run models again, but this time without Inflation as control variable
# Create matrix to store p.Values of Granger-Test
var_ticker_without_inflation <- matrix(NA, ncol = 2, nrow = 2)
colnames(var_ticker_without_inflation) <- c('p.Value.war','p.Value.index')
rownames(var_ticker_without_inflation) <- colnames(war_ticker_df)[3:4]
# Create matrix to store selected lags
lag_selected_matrix_without_inflation <- matrix(NA, ncol = 4, nrow = length(ticker_cols))
colnames(lag_selected_matrix_without_inflation) <- c('AIC', 'HQ', 'SC', 'FPE')
rownames(lag_selected_matrix_without_inflation) <- ticker_cols
# List to store plots
irf_plots_list_without_inflation <- list()
for (Ticker in ticker_cols) {
# Create data for VAR
print(Ticker)
data_for_var <- cbind(war_interest=war_ticker_inflation_df$hits,
ticker=war_ticker_inflation_df[[Ticker]])
# Run VAR model
VAR_est <- VAR(data_for_var, ic = "AIC", lag.max = 21)
coefs <-coeftest(VAR_est)
summ <- summary(VAR_est)
lag_selected <- VARselect(data_for_var, lag.max = 21, type = "both")
#print(coefs)
print(summ)
print(Ticker)
print(lag_selected)
# Run Granger Causality Test
causal <- causality(VAR_est, cause="war_interest")["Granger"]
#print(causal)
var_ticker_without_inflation[Ticker,1] <- causal$Granger$p.value
# Run Granger Causality Test other way (check if index has influence on crisis measure)
causal_ticker <- causality(VAR_est, cause="ticker")["Granger"]
#print(causal_ticker)
var_ticker_without_inflation[Ticker,2] <- causal_ticker$Granger$p.value
# Store selected lag for information criterion
var_ticker_without_inflation[Ticker, 'AIC'] <- lag_selected$selection["AIC(n)"]
var_ticker_without_inflation[Ticker, 'HQ'] <- lag_selected$selection["HQ(n)"]
var_ticker_without_inflation[Ticker, 'SC'] <- lag_selected$selection["SC(n)"]
var_ticker_without_inflation[Ticker, 'FPE'] <- lag_selected$selection["FPE(n)"]
# Save Impulse response functions
plot(irf(VAR_est, impulse="war_interest", response="ticker"), main=Ticker)
irf_plots_list_without_inflation[[Ticker]] <- recordPlot()
}
# Run models again, but this time without Inflation as control variable
# Create matrix to store p.Values of Granger-Test
var_ticker_without_inflation <- matrix(NA, ncol = 2, nrow = 2)
colnames(var_ticker_without_inflation) <- c('p.Value.war','p.Value.index')
rownames(var_ticker_without_inflation) <- colnames(war_ticker_df)[3:4]
# Create matrix to store selected lags
lag_selected_matrix_without_inflation <- matrix(NA, ncol = 4, nrow = length(ticker_cols))
colnames(lag_selected_matrix_without_inflation) <- c('AIC', 'HQ', 'SC', 'FPE')
rownames(lag_selected_matrix_without_inflation <- ticker_cols
# List to store plots
irf_plots_list_without_inflation <- list()
# Run models again, but this time without Inflation as control variable
# Create matrix to store p.Values of Granger-Test
var_ticker_without_inflation <- matrix(NA, ncol = 2, nrow = 2)
colnames(var_ticker_without_inflation) <- c('p.Value.war','p.Value.index')
rownames(var_ticker_without_inflation) <- colnames(war_ticker_df)[3:4]
# Create matrix to store selected lags
lag_selected_matrix_without_inflation <- matrix(NA, ncol = 4, nrow = length(ticker_cols))
colnames(lag_selected_matrix_without_inflation) <- c('AIC', 'HQ', 'SC', 'FPE')
rownames(lag_selected_matrix_without_inflation) <- ticker_cols
# List to store plots
irf_plots_list_without_inflation <- list()
for (Ticker in ticker_cols) {
# Create data for VAR
print(Ticker)
data_for_var <- cbind(war_interest=war_ticker_inflation_df$hits,
ticker=war_ticker_inflation_df[[Ticker]])
# Run VAR model
VAR_est <- VAR(data_for_var, ic = "AIC", lag.max = 21)
coefs <-coeftest(VAR_est)
summ <- summary(VAR_est)
lag_selected <- VARselect(data_for_var, lag.max = 21, type = "both")
#print(coefs)
print(summ)
print(Ticker)
print(lag_selected)
# Run Granger Causality Test
causal <- causality(VAR_est, cause="war_interest")["Granger"]
#print(causal)
var_ticker_without_inflation[Ticker,1] <- causal$Granger$p.value
# Run Granger Causality Test other way (check if index has influence on crisis measure)
causal_ticker <- causality(VAR_est, cause="ticker")["Granger"]
#print(causal_ticker)
var_ticker_without_inflation[Ticker,2] <- causal_ticker$Granger$p.value
# Store selected lag for information criterion
lag_selected_matrix_without_inflation[Ticker, 'AIC'] <- lag_selected$selection["AIC(n)"]
lag_selected_matrix_without_inflation[Ticker, 'HQ'] <- lag_selected$selection["HQ(n)"]
lag_selected_matrix_without_inflation[Ticker, 'SC'] <- lag_selected$selection["SC(n)"]
lag_selected_matrix_without_inflation[Ticker, 'FPE'] <- lag_selected$selection["FPE(n)"]
# Save Impulse response functions
plot(irf(VAR_est, impulse="war_interest", response="ticker"), main=Ticker)
irf_plots_list_without_inflation[[Ticker]] <- recordPlot()
}
# Run models again, but this time without Inflation as control variable
# Create matrix to store p.Values of Granger-Test
var_ticker_without_inflation <- matrix(NA, ncol = 2, nrow = 2)
colnames(var_ticker_without_inflation) <- c('p.Value.war','p.Value.index')
rownames(var_ticker_without_inflation) <- colnames(war_ticker_df)[3:4]
# Create matrix to store selected lags
lag_selected_matrix_without_inflation <- matrix(NA, ncol = 4, nrow = length(ticker_cols))
colnames(lag_selected_matrix_without_inflation) <- c('AIC', 'HQ', 'SC', 'FPE')
rownames(lag_selected_matrix_without_inflation) <- ticker_cols
# List to store plots
irf_plots_list_without_inflation <- list()
for (Ticker in ticker_cols) {
# Create data for VAR
print(Ticker)
data_for_var <- cbind(war_interest=war_ticker_inflation_df$hits,
ticker=war_ticker_inflation_df[[Ticker]])
# Run VAR model
VAR_est <- VAR(data_for_var, ic = "AIC", lag.max = 21)
coefs <-coeftest(VAR_est)
summ <- summary(VAR_est)
lag_selected <- VARselect(data_for_var, lag.max = 21, type = "both")
#print(coefs)
print(summ)
print(Ticker)
print(lag_selected)
# Run Granger Causality Test
causal <- causality(VAR_est, cause="war_interest")["Granger"]
#print(causal)
var_ticker_without_inflation[Ticker,1] <- causal$Granger$p.value
# Run Granger Causality Test other way (check if index has influence on crisis measure)
causal_ticker <- causality(VAR_est, cause="ticker")["Granger"]
#print(causal_ticker)
var_ticker_without_inflation[Ticker,2] <- causal_ticker$Granger$p.value
# Store selected lag for information criterion
lag_selected_matrix_without_inflation[Ticker, 'AIC'] <- lag_selected$selection["AIC(n)"]
lag_selected_matrix_without_inflation[Ticker, 'HQ'] <- lag_selected$selection["HQ(n)"]
lag_selected_matrix_without_inflation[Ticker, 'SC'] <- lag_selected$selection["SC(n)"]
lag_selected_matrix_without_inflation[Ticker, 'FPE'] <- lag_selected$selection["FPE(n)"]
# Save Impulse response functions
plot(irf(VAR_est, impulse="war_interest", response="ticker"), main=Ticker)
irf_plots_list_without_inflation[[Ticker]] <- recordPlot()
}
var_ticker_without_inflation
lag_selected_matrix_without_inflation
knitr::kable(lag_selected_matrix_without_inflation)
knitr::kable(lag_selected_matrix_without_inflation)
irf_plots_list_without_inflation$XLB.Adjusted
irf_plots_list_without_inflation$XLI.Adjusted
knitr::kable(var_ticker_without_inflation)
knitr::kable(var_ticker_without_inflation)
